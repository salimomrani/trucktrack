<header class="top-header">
  <!-- Left: Mobile menu toggle -->
  <div class="header-left">
    <button
      type="button"
      class="menu-toggle"
      (click)="onToggleSidebar()"
      [attr.aria-label]="'HEADER.MENU' | translate">
      <span class="material-icons">menu</span>
    </button>
  </div>

  <!-- Right: Actions -->
  <div class="header-right">
    <!-- Language selector -->
    <app-language-selector />

    <!-- Theme toggle -->
    <button
      type="button"
      class="action-btn"
      (click)="toggleTheme()"
      [attr.aria-label]="isDark() ? ('HEADER.LIGHT_MODE' | translate) : ('HEADER.DARK_MODE' | translate)">
      @if (isDark()) {
        <span class="material-icons">light_mode</span>
      } @else {
        <span class="material-icons">dark_mode</span>
      }
    </button>

    <!-- Notifications -->
    <div class="relative">
      <button
        type="button"
        class="action-btn"
        (click)="toggleNotifications()"
        [attr.aria-label]="'HEADER.NOTIFICATIONS' | translate"
        [attr.aria-expanded]="notificationsOpen()">
        <span class="material-icons">notifications_none</span>
        @if (unreadCount() > 0) {
          <span class="notification-badge">{{ formatBadge(unreadCount()) }}</span>
        }
      </button>

      @if (notificationsOpen()) {
        <app-notifications-dropdown (closed)="closeNotifications()" />
      }
    </div>

    <!-- User avatar -->
    <div class="relative">
      <button
        type="button"
        class="user-avatar-btn"
        (click)="toggleUserMenu()"
        [attr.aria-label]="'HEADER.USER_MENU' | translate"
        [attr.aria-expanded]="userMenuOpen()">
        <span class="user-avatar">{{ getInitials() }}</span>
      </button>

      @if (userMenuOpen()) {
        <div class="user-menu">
          <div class="user-menu-header">
            <p class="user-name">{{ getUserDisplayName() }}</p>
            <p class="user-email">{{ currentUser()?.email }}</p>
          </div>
          <div class="user-menu-divider"></div>
          <a routerLink="/profile" class="user-menu-item" (click)="closeUserMenu()">
            <span class="material-icons">person</span>
            <span>{{ 'AUTH.PROFILE' | translate }}</span>
          </a>
          <button type="button" class="user-menu-item user-menu-item-danger" (click)="logout()">
            <span class="material-icons">logout</span>
            <span>{{ 'AUTH.LOGOUT' | translate }}</span>
          </button>
        </div>
      }
    </div>
  </div>
</header>
